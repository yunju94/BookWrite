<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    >

<head>

    <meta charset="UTF-8">
    <title>조은북</title>
    <meta name="_csrf" th:content="${_csrf.token}">
    <meta name="_csrf_header" th:content="${_csrf.headerName}">

    <script th:inline="javascript">
        function handleSubmit(event) {
              event.preventDefault(); // 기본 폼 제출을 막음
              var form = document.getElementById('boardForm');
              var formData = new FormData(form);

              fetch(form.action, {
                  method: 'POST',
                  body: formData,
                  headers: {
                      'Accept': 'application/json',
                  },
              })
              .then(response => {
                  if (response.ok) {
                      window.close(); // 성공적으로 제출되면 창을 닫음
                  } else {
                      // 오류 처리
                      alert('폼 제출에 실패했습니다.');
                  }
              })
              .catch(error => {
                  // 네트워크 오류 처리
                  console.error('폼 제출 중 오류 발생:', error);
                  alert('폼 제출 중 오류 발생.');
              });
          }

    </script>


    <style>


    </style>
</head>

<body>
<div layout:fragment="content">
    <h3>관리자에게 문의 요청</h3>
    <form id="boardForm" method="post" th:action="@{/write/boardPop}" th:object="${boardDto}" onsubmit="handleSubmit(event)">
        <input type="hidden" th:field="*{member.nickname}" readonly>
        <textarea cols="100" rows="30" placeholder="보낼 글을 작성해주세요" th:field="*{content}"></textarea>
        <button type="submit">보내기</button>
    </form>

</div>
</body>

